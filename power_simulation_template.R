.libPaths(new="~/R")

rm(list=ls())

setwd("~/hdi_simu")
source("path_related.R")
source("path_power.R")
source("path_resample.R")


require(LOCOpath)
options(echo=TRUE)

args <- commandArgs(trailingOnly = TRUE)

n <- as.numeric(args[1])
p <- as.numeric(args[2])
iter <- as.numeric(args[3]) 
B <- as.numeric(args[4])
save.name <- args[5]
beta_i = as.numeric(args[6])

###################################################
###################################################
###################################################

bb = beta_i / 10
for (rho in list(0, 0.5, 0.9, 'equl', 'weak_equl')){

results = Path.Resample.Power(n = n, p = p, beta=c(0+bb,rep(1,2),rep(0,77)), rho=rho, iter = iter, B = B, setting = 'dep', which.covariate = 1, betaNull = 0, multiTest = FALSE, parallel = TRUE, norm = 'L2.squared', path.method ='lars', beta.init = 'adaptive')

print(results)
f1 = paste0("~/hdi_simu/results/",save.name,"_", 'L2', "_rho_", rho, 'bb_', bb, ".RData")
print(f1)
save(results,file = f1)

##############

results = Path.Resample.Power(n = n, p = p, beta=c(0+bb,rep(1,2),rep(0,77)), rho=rho, iter = iter, B = B, setting = 'dep', which.covariate = 1, betaNull = 0, multiTest = FALSE, parallel = TRUE, norm = 'L1', path.method ='lars', beta.init = 'adaptive')
print(results)
f1 = paste0("~/hdi_simu/results/",save.name,"_", 'L1', "_rho_", rho, 'bb_', bb, ".RData")
print(f1)
save(results,file = f1)

##############

results = Path.Resample.Power(n = n, p = p, beta=c(0+bb,rep(1,2),rep(0,77)), rho=rho, iter = iter, B = B, setting = 'dep', which.covariate = 1, betaNull = 0, multiTest = FALSE, parallel = TRUE, norm = 'L_inf', path.method ='lars', beta.init = 'adaptive')
print(results)
f1 = paste0("~/hdi_simu/results/",save.name,"_", 'L_inf', "_rho_", rho, 'bb_', bb, ".RData")
print(f1)
save(results,file = f1)

}


